#表示linux执行命令

机器准备

master节点，IP地址192.168.56.160，安装etcd、kube-apiserver、kube-controller-manager、kube-scheduler
修改hostname（k8s-master）
#vi /etc/hostname

node节点，IP地址192.168.56.161，安装docker、kubelet、kube_proxy
修改hostname（k8s-node1）
#vi /etc/hostname

node节点，IP地址192.168.56.162，安装docker、kubelet、kube_proxy
修改hostname（k8s-node2）
#vi /etc/hostname

所有机器初始化环境（关闭防火墙和swap）
#systemctl stop firewalld && systemctl disable firewalld
#setenforce 0
设置SELINUX=disabled
#vi /etc/selinux/config
#swapoff -a && sysctl -w vm.swappiness=0

如果是使用visualbox等虚拟机软件，需要注释掉UUID，物理机或云主机跳过此步骤
#vi /etc/fstab
这一行注释掉#UUID=5b0b2f7c-8887-42dd-91ec-57071d0e5e0f /boot      xfs     defaults    0 0

master节点
安装ETCD:
将下载的etcd文件包进行解压，解压后将etcd、etcdctl二进制文件复制到/usr/bin目录。
#cp etcd etcdctl /usr/bin
#mkdir -p /etc/etcd
#touch /usr/lib/systemd/system/etcd.service
#touch /etc/etcd/etcd.conf

etcd.service、etcd.conf文件内容在etcd目录有例子

启动ETCD：
#systemctl daemon-reload
#systemctl enable etcd.service
#systemctl start etcd.service
验证ETCD：
#etcdctl cluster-health

master节点
安装kubectl、kube-apiserver、kube-controller-manager、kube-scheduler
在解压的/kubernetes/server/bin目录中将kubectl、kube-apiserver、kube-controller-manager、kube-scheduler可执行文件复制到/usr/bin目录
#cp kubectl、kube-apiserver、kube-controller-manager、kube-scheduler /usr/bin
#mkdir -p /etc/kubernetes
#touch /usr/lib/systemd/system/kube-apiserver.service
#touch /etc/kubernetes/apiserver
#touch /usr/lib/systemd/system/kube-controller-manager.service
#touch /etc/kubernetes/controller-manager
#touch /usr/lib/systemd/system/kube-scheduler.service
#touch /etc/kubernetes/scheduler

kube-apiserver.service、apiserver、kube-controller-manager.service、controller-manager、kube-scheduler.service、scheduler文件内容在master目录有例子

启动:
#systemctl daemon-reload 
#systemctl enable kube-apiserver.service
#systemctl start kube-apiserver.service
#systemctl enable kube-controller-manager.service
#systemctl start kube-controller-manager.service
#systemctl enable kube-scheduler.service
#systemctl start kube-scheduler.service
验证：
#kubectl get cs

node节点
安装docker
#yum -y install docker

安装kube-proxy
在解压的/kubernetes/node/bin将kube-proxy可执行文件复制到/usr/bin目录
#cp kube-proxy /usr/bin
#mkdir -p /etc/kubernetes
#touch /usr/lib/systemd/system/kube-proxy.service
#touch /etc/kubernetes/proxy
#touch /etc/kubernetes/config

kube-proxy.service、proxy、config文件内容在node目录有例子

启动:
#systemctl daemon-reload
#systemctl enable kube-proxy.service
#systemctl start kube-proxy.service
验证：
#netstat -lntp | grep kube-proxy

安装kubelet
在解压的/kubernetes/node/bin将kubelet可执行文件复制到/usr/bin目录
#cp kubelet /usr/bin
#mkdir -p /var/lib/kubelet
#touch /usr/lib/systemd/system/kubelet.service
#touch /etc/kubernetes/kubelet
#touch /var/lib/kubelet/kubeconfig

kubelet.service、kubelet、kubeconfig文件内容在node目录有例子

启动：
#systemctl daemon-reload
#systemctl enable kubelet.service
#systemctl start kubelet.service
验证：
#netstat -tnlp | grep kubelet

master验证node
#kubectl get node
